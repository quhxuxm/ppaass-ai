# PPAASS Proxy Server Configuration
# This configuration is for demo purposes with real RSA keys

# Address to listen for incoming agent connections
listen_addr = "0.0.0.0:8080"

# Address for REST API (user management, monitoring)
api_addr = "0.0.0.0:8081"

# Enable REST API server for user management and monitoring (default: false)
enable_api = false

# Path to SQLite database for user management
database_path = "config/local/data/users.db"

# Directory where RSA keys are stored
keys_dir = "config/local/keys"

# Log level: trace, debug, info, warn, error
log_level = "debug"

# Log directory for file-based logging (better performance than console)
# log_dir = "logs"

# Compression mode for data transfer: none, zstd, lz4, gzip
# - none: No compression (default)
# - zstd: Zstandard compression - good balance of speed and ratio
# - lz4: LZ4 compression - fastest, lower compression ratio
# - gzip: Gzip compression - widely compatible, slower
compression_mode = "none"

# Number of Tokio runtime worker threads (defaults to CPU cores if not set)
# runtime_threads = 4

# Database Connection Pool Configuration
# ========================================
# Configuration for SQLite database connection pooling

[db_pool]
# Maximum number of concurrent database connections (default: 32)
max_connections = 32

# Minimum number of connections to maintain in the pool (default: 5)
min_connections = 5

# Connection timeout in seconds (default: 8)
connect_timeout_secs = 8

# Idle timeout in seconds - connections idle longer than this are closed (default: 300 = 5 minutes)
idle_timeout_secs = 300

# Maximum lifetime of a connection in seconds before it's recycled (default: 3600 = 1 hour)
max_lifetime_secs = 3600


replay_attack_tolerance = 300

# Forward Mode Configuration
# --------------------------
# If enabled, this proxy will forward all traffic to another PPAASS proxy
# instead of connecting directly to the target.
# forward_mode = false

# Upstream proxy address (required if forward_mode = true)
# upstream_proxy_addr = "127.0.0.1:9090"

# Username to authenticate with the upstream proxy
# upstream_username = "user2"

# Path to the private key for authenticating with the upstream proxy
# upstream_private_key_path = "keys/user2.pem"

# List of upstream proxy addresses for load balancing and failover
# When multiple addresses are specified, one will be randomly selected for each connection
# upstream_proxy_addrs = ["upstream-proxy1:8080", "upstream-proxy2:8080"]

# Connection timeout in seconds for upstream proxy connections (default: 30 seconds)
# connect_timeout_secs = 30

# Optional: Enable tokio-console for debugging
# console_port = 6670
